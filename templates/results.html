<!DOCTYPE html>
<html>
<head>
  <title>Analysis Results</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    .meta { color: #555; margin-bottom: 12px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 10px; }
    img { width: 100%; height: auto; border-radius: 8px; }
    pre { white-space: pre-wrap; background: #f7f7f8; padding: 12px; border-radius: 8px; }
    .card { border: 1px solid #eee; border-radius: 10px; padding: 12px; background: #fff; }
    .tag { display: inline-block; background: #eef2ff; color: #3730a3; padding: 2px 8px; border-radius: 999px; font-size: 12px; margin-right: 6px; }
  </style>
</head>
<body>
  <h1>Analysis Results</h1>

  <div class="meta">
    <div><strong>URL:</strong> {{ tiktok_url }}</div>
    {% if creator_note %}<div><strong>Your note:</strong> {{ creator_note }}</div>{% endif %}
    <div>
      <span class="tag">Strategy: {{ strategy }}</span>
      <span class="tag">Cap: {{ cap }}</span>
      {% if strategy == 'uniform' %}
        <span class="tag">Frames/min: {{ frames_per_minute }}</span>
      {% else %}
        <span class="tag">Scene threshold: {{ scene_threshold }}</span>
      {% endif %}
      <span class="tag">Frames kept: {{ frames_count }}</span>
    </div>
  </div>

  <h2>Transcript</h2>
  <pre>{{ transcript }}</pre>

  <h2>Frames (sampled)</h2>
  <div class="grid">
    {% for img in frame_gallery %}
      <div class="card"><img src="{{ img }}" alt="Frame"></div>
    {% endfor %}
  </div>

  <h2>Frame-by-frame Visual Notes</h2>
  {% for block in frame_summaries %}
    <div class="card">
      <pre>{{ block }}</pre>
    </div>
  {% endfor %}

  <h2>Custom GPT Synthesis</h2>
  <div class="card">
    <pre>{{ gpt_response }}</pre>
  </div>

  <h2>Improved Script</h2>
  <div class="card">
    <pre>{{ improved_script }}</pre>
  </div>

  <p><a href="/">Analyze another</a></p>
</body>
</html>
